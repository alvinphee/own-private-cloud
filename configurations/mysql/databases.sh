#!/bin/bash

mysql -uroot -p"${MYSQL_ROOT_PASSWORD}" <<- EOSQL
            
      -- Standard notes
      CREATE DATABASE IF NOT EXISTS \`${DB_DATABASE}\`;
      CREATE USER '${DB_USERNAME}'@'%' IDENTIFIED BY '${DB_PASSWORD}';
      GRANT ALL ON \`${DB_DATABASE}\`.* TO '${DB_USERNAME}'@'%';

      -- Passbolt
      CREATE DATABASE IF NOT EXISTS \`${DATASOURCES_DEFAULT_DATABASE}\`;
      CREATE USER '${DATASOURCES_DEFAULT_USERNAME}'@'%' IDENTIFIED BY '${DATASOURCES_DEFAULT_PASSWORD}';
      GRANT ALL ON \`${DATASOURCES_DEFAULT_DATABASE}\`.* TO '${DATASOURCES_DEFAULT_USERNAME}'@'%';

      -- BaÃ¯kal
      CREATE DATABASE IF NOT EXISTS \`${BAIKAL_DATABASE}\`;
      CREATE USER '${BAIKAL_USERNAME}'@'%' IDENTIFIED BY '${BAIKAL_PASSWORD}';
      GRANT ALL ON \`${BAIKAL_DATABASE}\`.* TO '${BAIKAL_USERNAME}'@'%';

      -- OnlyOffice
      CREATE DATABASE IF NOT EXISTS \`${MYSQL_SERVER_DB_NAME}\`;
      CREATE USER '${MYSQL_SERVER_USER}'@'localhost' IDENTIFIED BY '${MYSQL_SERVER_PASS}';
      GRANT ALL ON \`${MYSQL_SERVER_DB_NAME}\`.* TO '${MYSQL_SERVER_USER}'@'%';
      FLUSH PRIVILEGES;
EOSQL